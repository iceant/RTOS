# 背景

## 硬件介绍

### GD32F303CGT6

1. 采集CAN数据，打包，发送给`GD32F470VGT6`
2. 发送心跳给 `GD32F470VGT6`



### GD32F470VGT6

1. 采集电压、电流、计算电能

2. 

3. 负责网络通讯

4. 网络对时校准时间

5. 将时间发送给 `GD32F303CGT6`

6. 接收电能数据包并发送

7. 采集电压、电流、计算电能

8. 电能上报

9. 心跳上报

10. 网络连接

11. SD卡读写

12. 电能显示在OLED屏幕上

13. 接收`GD32F303CGT6`的心跳，当超时未能接收到心跳，上报异常

14. 时间读取服务，每秒同步一次RTC硬件时钟，系统其它组件通过该服务获取当前时间，避免硬件过度读取

15. MQTT上报，支持异步上报

16. 处理按键，当按下按键时物理断开 CC1，并通知MCU，显示红灯

17. 串口命令

    - 重启 reboot
    - 配置 meter.std_voltage_min
    - 配置 meter.std_current_min
    - 配置 meter.voltage_ratio
    - 配置 meter.current_ratio

    

    

    